---
title: "Cross-Origin Resource Sharing"
categories:
    - Threat Analysis
tags:
    - cors
toc: true
---

> 본 포스트는 제가 이해한 방식으로 설명한 것이니 실제 정보와 다를 수 있습니다.

# Cross-Origin Resource Sharing(CORS) 란?
요즘 웹사이트를 가보면 네이버나 카카오 등 다른 사이트의 인증된 계정으로 가입이나 로그인할 수 있게 연동되어 있다.
API를 이용하여 타 서비스에 로그인을 하고 인증된 정보를 통해 본 웹사이트도 인증이 되도록 하는 방식으로 구성되어 있기 때문이다.

## 예를 들면,
내가 website.com을 운영하고 있고 네이버의 계정으로 가입 및 로그인할 수 있도록 서비스를 하는 중이다.
네이버 로그인을 하면 API를 통해 해당 자격 증명을 불러오고 이를 위해선 나의 웹 사이트에 naver.com으로 들어오는 정보를 받을 수 있어야 한다.

모든 브라우저는 Same-Origin Policy를 적용하고 있고 정상적인 이용객이라면 같은 사이트의 도메인 안에서 서비스를 이용한다.
예전에는 모든 웹사이트는 자체적으로 DB를 가지고 있고 해당 DB에 등록된 계정만으로 로그인을 할 수 있었고, 다른 사이트의 계정 정보를 불러와 로그인을 한다는 건 말이 안되는 구조였다.

그렇기 때문에 Same-Origin 이라는 건 당연했고 이에 대한 보안 헤더도 존재하지 않았을 것이다.

## 요즘 추세는
구글이던 네이버던 대형 포탈 서비스에 계정이 있다면 그 계정으로 손 쉽게 회원 가입이 가능하고 로그인도 된다.
API라는 기술이 생겨나면서 이러한 서비스도 생겨난게 아닌가 추측한다.

다시 말하자면 우리가 웹서비스를 제공하고자 할 때 네이버나 카카오 등으로 부터 API를 제공받을 것이고 이를 활용하여 웹사이트를 구축할 것이다.
내 웹사이트에서 로그인할 때 네이버를 클릭해서 로그인을 하고 네이버 도메인에서 인증되었다라는 요청(Request)를 주면 내 웹사이트가 인증되었다는 응답을 해주는 것이다.

## 이 방법을 이용하려면
나는 내 웹사이트에서 naver.com이라는 도메인을 출처를 허가해주어야 한다.
Access-Control-Allow-Origin: https://www.naver.com 라는 응답 헤더가 있다면 네이버로부터 가져오는 데이터는 허용이 된다는 말이다.

네이버만 허용해주면야 문제는 없다만 이 기술을 도입한 서비스라면 구글, 카카오도 연동을 해놨을 것이고, 귀찮은 서버 담당자라면 "Access-Control-Allow-Origin: *"로 설정해뒀을 것이다.
단순 저 3개의 서비스만이라면 3개만 등록하면 되지만 API를 통해 데이터를 긁어오는 사이트들이 많을거고 연동할 때마다 서버의 아파치같은 서버 구동 서비스의 설정을 변경하고 재시작할 수도 없을 노릇이니 모든 도메인을 허용해줄 가능성이 크다.

## 이러한 보안홀을 이용하는 것이다.



## Reference
https://www.packetlabs.net/posts/cross-origin-resource-sharing-cors/
https://evan-moon.github.io/2020/05/21/about-cors/
https://guleum-zone.tistory.com/169
https://eunjinii.tistory.com/43